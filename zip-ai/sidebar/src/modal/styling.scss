// Common variables used across the styled components.
$palette-primary: #007cba;
$palette-error: #e34848;
$palette-warning: #ca8a04;
$palette-chat-background: #f6fafe;
$palette-chat-scrollbar: #b0b9c6; // The $palette-label-icon color, but 50% lighter.
$palette-chat-border: #e6e7e9;
$palette-chat-button: #f8fafc;
$palette-chat-code-title: #1f2937; // a.k.a. Gray 800.
$palette-chat-code-body: #374151; // a.k.a. Gray 700.
$palette-label-background: #ecf3f9; // The $palette-chat-background color, but 2.5% darker and 50% saturated.
$palette-label-border: #e2e8f0;
$palette-label-icon: #64748b; // a.k.a. Slate 500.
$palette-text-body: #50575e;
$palette-text-placeholder: #aaa;
$palette-text-help: #959aa3;

// Common variables used for calculations.
$section-gap: 8px;

// All Spectra Open AI Modal CSS.
.spectra-open-ai {

	// The modal styling.
	&-modal {
		width: 450px;
		min-width: 450px;
		max-width: 450px;
		height: 100vh;
		max-height: 100vh;
		margin-right: 0;
		position: relative;
		top: 0;
		right: 0;
		border-radius: 0;
		box-shadow: -16px 0 80px -24px rgba(0, 0, 0, 0.16);
		overflow: visible;
		animation: slideInRight 250ms 0s 1 ease-in-out none !important;

		// The content-area styling.
		.components-modal__content {
			display: flex;
			flex-direction: column;
			padding: 0;
			margin-top: 60px;

			& > div:not(.components-modal__header) {
				max-height: calc(100vh - 60px);
				flex: 1;
				display: flex;
				flex-direction: column;
				background-color: $palette-chat-background;
			}
		}

		// The styling of the modal's header.
		.components-modal__header {
			height: 60px;
			margin: 0;
			padding: 12px 12px 12px 12px;
			text-align: center;
			box-shadow: 0 1px $palette-chat-border;

			// The styling of the header's heading area.
			.components-modal__header-heading-container {
				justify-content: center;
			}

			// The close button in the header.
			.components-button {
				position: absolute;
				top: 0;
				left: 0;
				width: 60px;
				height: 60px;
				padding: 4px;
				color: #000;

				// The right arrow icon to replace the SVG.
				&::before {
					content: "\2192";
					width: 24px;
					height: 24px;
					font-size: 24px;
					line-height: 24px;
					text-align: center;
					vertical-align: middle;
					display: inline-block;
					-webkit-font-smoothing: antialiased;
					-moz-osx-font-smoothing: grayscale;
				}

				// Hide the close button icon.
				svg {
					display: none;
				}
			}

			// The logo of the sidebar.
			.components-modal__icon-container {
				display: flex;
				align-items: center;
				margin-top: 0;
				margin-right: 12px;

				// The SVG in the logo container.
				svg {
					height: 32px;
				}
			}
		}

		// The notification bar.
		&__notification {
			position: relative;
			height: 40px;
			max-height: 0;
			overflow: hidden;
			background-color: $palette-error;
			color: #fff;
			box-shadow: 0 1px $palette-chat-border;
			-webkit-transition: max-height 250ms ease-in-out;
			-moz-transition: max-height 250ms ease-in-out;
			-o-transition: max-height 250ms ease-in-out;
			transition: max-height 250ms ease-in-out;

			&--visible {
				max-height: 40px;
			}

			&--content {
				position: absolute;
				bottom: 0;
				height: 40px;
				width: 100%;
				padding: 0 20px;
				display: flex;
				flex-direction: row;
				justify-content: space-between;
				align-items: center;
				font-size: 14px;
				font-weight: 500;
				line-height: 1.5;
				letter-spacing: 0.1px;
			}

			// The close button in the notification bar.
			.components-button {
				width: 24px;
				height: 24px;
				padding: 4px;
				position: absolute;
				top: 8px;
				right: 8px;

				// The close button icon.
				svg {
					width: 20px;
					height: 20px;
					color: #fff;
				}
			}
		}

		// The chat window.
		&__chat-window {
			flex: 1;
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-items: flex-start;
			padding: 20px 0 20px 20px;
			gap: 16px;
			overflow-y: scroll;
			// Firefox scrollbar styles.
			scrollbar-width: auto;
			scrollbar-color: $palette-chat-scrollbar $palette-chat-background;

			// Chrome, Edge and Safari scrollbar dimensions.
			&::-webkit-scrollbar {
				width: 20px;
				width: 20px;
			}

			// Chrome, Edge and Safari scrollbar track.
			&::-webkit-scrollbar-track {
				border-radius: 10px;
				background-color: $palette-chat-background;
			}

			// Chrome, Edge and Safari scrollbar thumb.
			&::-webkit-scrollbar-thumb {
				border-radius: 10px;
				background-color: $palette-chat-scrollbar;
				border: 6px solid $palette-chat-background;
			}

			// Focus border styling.
			&:focus-visible {
				outline: 0;
				box-shadow: none;
				border-color: $palette-chat-scrollbar;
			}

			// The placeholder styling.
			&::placeholder {
				color: $palette-text-placeholder;
			}

			// The placeholder for the chat window.
			&--placeholder {
				flex: 1;
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
				padding: 32px;
				gap: 16px;
				width: 100%;

				// The heading and subheading in the placeholder.
				&-heading,
				&-subheading {
					margin: 0;
					padding: 0;
					text-align: center;
				}
			}
		}

		// The chat bubbles inside the chat window. The SCSS definition does not use the common &__chat- from above for readability.
		&__chat-bubble {
			position: relative;
			width: 100%;
			display: flex;
			flex-direction: column;
			border: 1px solid $palette-label-border;
			border-radius: 8px;
			background: #fff;
			padding: 16px;
			gap: 6px;
			animation: chatBubble 150ms 0s 1 ease none;

			// The hover styling of the chat bubble.
			&:hover {

				// The chat bubble header interactions that are visible on hover.
				.spectra-open-ai-modal__chat-bubble--interaction-on-hover {
					opacity: 1;
				}
			}

			// The chat bubble header and footer areas.
			&--header,
			&--footer {
				display: flex;
				justify-content: space-between;
			}

			// The chat bubble footer area specific CSS.
			&--footer {
				margin-top: 6px;
			}

			// The chat bubble username.
			&--user {
				flex: 1;
				margin: 0;
				padding: 0;
				color: $palette-text-body;
				font-size: 16px;
				font-weight: 600;
				line-height: 24px;
			}

			// The chat bubble header interactions.
			&--interaction {
				display: flex;
				justify-content: flex-end;
				gap: 8px;

				// The chat bubble header interactions that are visible on hover.
				&-on-hover {
					opacity: 0;
					-webkit-transition: opacity 150ms;
					-moz-transition: opacity 150ms;
					-o-transition: opacity 150ms;
					transition: opacity 150ms;
				}

				// The chat bubble header interaction buttons.
				button {
					width: 24px;
					height: 24px;
					padding: 4px;
					background-color: transparent;
					border: 0;
					cursor: pointer;

					// The chat bubble header interaction button icon.
					svg {
						width: 16px;
						height: 16px;
						color: $palette-text-placeholder;
						-webkit-transition: color 150ms;
						-moz-transition: color 150ms;
						-o-transition: color 150ms;
						transition: color 150ms;
					}

					// The chat bubble header interaction button icon hover state.
					&:hover,
					&:focus-visible {
						outline: 0;
						box-shadow: none;

						svg {
							color: $palette-text-body;
						}
					}

					// The chat bubble header interaction button icon disabled state.
					&:disabled {
						cursor: progress;

						svg {
							color: $palette-chat-border !important;
						}
					}
				}
			}

			// The chat bubble message.
			&--message {
				margin: 0;
				padding: 0;
				color: $palette-text-body;
				font-size: 16px;
				font-weight: 400;
				line-height: 24px;
				white-space: pre-wrap;
			}

			// The code block formatting for the chat bubble message.
			&--code-block {
				margin: 0;
				padding: 0;
				font-size: 16px;
				font-weight: 400;
				line-height: 24px;
				white-space: pre-wrap;

				// The code block title.
				&-title {
					display: flex;
					align-items: center;
					justify-content: space-between;
					margin: 0;
					padding: 8px 12px;
					color: #fff;
					background-color: $palette-chat-code-title;
					font-size: 16px;
					font-weight: 600;
					line-height: 24px;
					border-radius: 6px 6px 0 0;
				}

				// The code block title actions area.
				&-actions {
					flex: 1;
					display: flex;
					gap: 8px;
					align-items: center;
					justify-content: flex-end;
				}

				// The code block title buttons
				&-button {
					width: 24px;
					height: 24px;
					padding: 2px;
					background-color: transparent;
					border: 0;
					cursor: pointer;

					// The code block title button icon.
					svg {
						width: 20px;
						height: 20px;
						color: #fff;
						-webkit-transition: filter 150ms;
						-moz-transition: filter 150ms;
						-o-transition: filter 150ms;
						transition: filter 150ms;
					}

					// The code block title button icon hover state.
					&:hover,
					&:focus-visible {
						outline: 0;
						box-shadow: none;

						svg {
							filter: drop-shadow(0 0 1px #fff);
						}
					}

					// The code block title button icon disabled state.
					&:disabled {
						cursor: progress;

						svg {
							color: $palette-chat-border !important;
						}
					}
				}

				// The code block content.
				&-content {
					margin: 0;
					padding: 12px;
					color: #fff;
					background-color: $palette-chat-code-body;
					border-radius: 0 0 6px 6px;
					overflow-x: auto;

					// The code block content code tag.
					code {
						padding: 0;
						margin: 0;
						color: #fff;
						background-color: transparent;
						font-size: 14px;
					}
				}
			}

			// The AI chat bubble accept buttons.
			&--action {
				cursor: pointer;
				padding: 8px 14px;
				font-size: 14px;
				font-weight: 400;
				line-height: 16px;
				color: $palette-text-body;
				background-color: $palette-chat-button;
				border: 1px solid $palette-chat-border;
				border-radius: 999px;
				-webkit-transition-property: color, background-color, border-color;
				-webkit-transition-duration: 100ms;
				-moz-transition-property: color, background-color, border-color;
				-moz-transition-duration: 100ms;
				-o-transition-property: color, background-color, border-color;
				-o-transition-duration: 100ms;
				transition-property: color, background-color, border-color;
				transition-duration: 100ms;

				&:hover,
				&:focus-visible {
					outline: 0;
					box-shadow: none;
					color: #fff;
					background-color: $palette-primary;
					border-color: $palette-primary;
				}
			}

			// The chat bubble pagination.
			&--pagination {
				display: flex;
				justify-content: center;
				align-items: center;
				gap: 8px;

				// The chat bubble pagination button.
				button {
					cursor: pointer;
					width: 24px;
					height: 24px;
					padding: 4px;
					background-color: transparent;
					border: 0;

					// The chat bubble pagination button icon.
					svg {
						width: 16px;
						height: 16px;
						color: $palette-text-placeholder;
						-webkit-transition: color 150ms;
						-moz-transition: color 150ms;
						-o-transition: color 150ms;
						transition: color 150ms;
					}

					// The chat bubble pagination button icon hover state.
					&:hover,
					&:focus-visible {
						outline: 0;
						box-shadow: none;

						svg {
							color: $palette-text-body;
						}
					}

					// the chat bubble pagination button icon disabled state.
					&:disabled {
						cursor: not-allowed;

						svg {
							color: $palette-chat-border !important;
						}
					}
				}

				// The chat bubble pagination page number.
				span {
					margin: 0;
					padding: 0;
					color: $palette-text-body;
					font-size: 14px;
					font-weight: 400;
					line-height: 24px;
				}
			}

			// The class added to the chat bubble to determine if it has an icon.
			&--has-icon {
				flex-direction: row;
			}

			// The Icon based classes of the chat bubble.
			&--icon {

				// The content section of the icon chat bubble.
				&-content {
					flex: 1;
					display: flex;
					flex-direction: column;
					gap: 12px;
				}
			}

			// The Error Bubble Type class that's added to the chat bubble.
			&--type-error {
				border-color: #fecaca;
				background: #fffbfa;

				// The message styling for the error bubble.
				.spectra-open-ai-modal__chat-bubble--message {
					color: #b42318;
				}

				// The action button styling for the error bubble.
				.spectra-open-ai-modal__chat-bubble--action {
					color: #d92d20;
					border: 0;
					background: transparent;
					font-size: 14px;
					font-weight: 600;
					line-height: 20px;
					padding: 0;

					&:hover,
					&:focus-visible {
						outline: 0;
						box-shadow: none;
						color: #b42318;
						background-color: transparent;
					}
				}

				// The icon styling for the error bubble.
				.spectra-open-ai-modal__chat-bubble--icon-wrapper path {
					stroke: #d92d20;
				}
			}
		}

		// The chat bubble editor.
		&__chat-editor {
			display: flex;
			flex-direction: column;
			gap: 8px;

			// The chat bubble editor input.
			&--input {
				padding: 4px 6px;
				border: 1px solid $palette-chat-border;
				border-radius: 4px;
				background-color: transparent;
				color: $palette-text-body;
				font-size: 16px;
				font-weight: 400;
				line-height: 24px;
				box-shadow: 0 0 transparent;
				-webkit-transition-property: border-color, box-shadow;
				-webkit-transition-duration: 150ms;
				-moz-transition-property: border-color, box-shadow;
				-moz-transition-duration: 150ms;
				-o-transition-property: border-color, box-shadow;
				-o-transition-duration: 150ms;
				transition-property: border-color, box-shadow;
				transition-duration: 150ms;

				// The error state of the chat bubble editor input, prioritized.
				&.spectra-open-ai-modal__chat-editor--input-error {
					border-color: $palette-error !important;

					// The chat bubble editor errornous input active state.
					&:active,
					&:focus,
					&:focus-visible {
						outline: 0;
						box-shadow: 0 0 0 1px $palette-error !important;
						border-color: $palette-error !important;
					}
				}

				// The chat bubble editor input active state.
				&:active,
				&:focus,
				&:focus-visible {
					outline: 0;
					box-shadow: 0 0 0 1px $palette-primary !important;
					border-color: $palette-primary !important;
				}
			}

			// The chat button editor actions.
			&--actions {
				display: flex;
				justify-content: flex-start;
				align-items: center;
				gap: 12px;

				// The chat button editor action buttons.
				button {
					cursor: pointer;
					padding: 0;
					border: 0;
					font-size: 14px;
					font-weight: 600;
					line-height: 20px;
					color: $palette-text-body;
					background: transparent;
					-webkit-transition: color 150ms;
					-moz-transition: color 150ms;
					-o-transition: color 150ms;
					transition: color 150ms;


					// The chat button editor action primary variant.
					&.spectra-open-ai-modal__chat-editor--action-primary {
						color: $palette-primary;

						// The disabled primary action button.
						&:disabled {
							cursor: not-allowed;
							color: $palette-text-placeholder !important;
						}
					}
				}
			}

			// The chat button editor info.
			&--info {
				text-align: left;
				color: $palette-warning;
				font-size: 10px;
				font-weight: 400;
				line-height: 12px;
			}
		}

		// The chat loader. The SCSS definition does not use the common &__chat- from above for readability.
		&__chat-loader {
			display: flex;
			gap: 6px;
			padding: 16px;
			animation: chatBubble 150ms 150ms 1 ease none;

			// The dots in the chat loader.
			&--dot {
				position: relative;
				width: 8px;
				height: 8px;
				border-radius: 999px;
				background-color: $palette-text-placeholder;
				opacity: 0.5;
				animation: jump 1500ms infinite ease-out both;

				// Set the delay for dot 2.
				&.dot-2 {
					animation-delay: 150ms;
				}

				// Set the delay for dot 3.
				&.dot-3 {
					animation-delay: 300ms;
				}
			}
		}

		// The content generation section.
		&__input-prompt {
			width: 100%;
			background-color: #fff;
			border-top: 1px solid $palette-label-border;
			padding: 16px 20px;
			position: relative;


			// The textarea that holds the prompt message.
			&--text {
				position: relative;
				width: 100%;
				padding: 8px;
				resize: none;
				overflow-y: auto;
				background: #fff;
				color: $palette-text-body;
				border: 1px solid $palette-chat-border;
				font-size: 16px;
				font-weight: 400;
				line-height: 22px;
				text-align: left;
				// Firefox scrollbar styles.
				scrollbar-width: thin;
				scrollbar-color: $palette-chat-border #fff;

				// Chrome, Edge and Safari scrollbar dimensions.
				&::-webkit-scrollbar {
					width: 12px;
					width: 12px;
				}

				// Chrome, Edge and Safari scrollbar track.
				&::-webkit-scrollbar-track {
					border-radius: 6px;
					background-color: #fff;
				}

				// Chrome, Edge and Safari scrollbar thumb.
				&::-webkit-scrollbar-thumb {
					border-radius: 6px;
					background-color: $palette-chat-border;
					border: 4px solid #fff;
				}

				// Focus border styling.
				&:focus-visible {
					outline: 0;
					box-shadow: none;
					border-color: $palette-chat-border;
				}

				// Disabled styling.
				&:disabled {
					cursor: not-allowed;
				}

				// The placeholder styling.
				&::placeholder {
					color: $palette-text-placeholder;
				}
			}

			// The disclaimer text.
			&--disclaimer {
				color: $palette-text-help;
				font-size: 12px;
				line-height: 16px;
				text-align: left;
			}

			&--footer {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-top: 16px;
				gap: 12px;
			}

			// The button in the prompt area.
			&--button {
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 8px;
				padding: 7px 12px;
				border-radius: 4px;
				border: 1px solid $palette-primary;
				background-color: $palette-primary;
				color: #fff;
				-webkit-transition-duration: 100ms;
				-moz-transition-duration: 100ms;
				-o-transition-duration: 100ms;
				transition-duration: 100ms;
				-webkit-transition-property: opacity;
				-moz-transition-property: opacity;
				-o-transition-property: opacity;
				transition-property: opacity;

				// The Secondary Variant.
				&.secondary-variant {
					color: $palette-primary;
					background-color: #fff;
					-webkit-transition-property: opacity, background-color, color;
					-moz-transition-property: opacity, background-color, color;
					-o-transition-property: opacity, background-color, color;
					transition-property: opacity, background-color, color;

					svg {
						color: $palette-primary;
						-webkit-transition: color 100ms;
						-moz-transition: color 100ms;
						-o-transition: color 100ms;
						transition: color 100ms;
					}

					&:hover {
						background-color: $palette-primary;
						color: #fff;

						svg {
							color: #fff;
						}
					}

					// The disabled button styling.
					&:disabled {
						opacity: 0.5;
						cursor: not-allowed;
						color: $palette-primary !important;
						background-color: #fff !important;
					}
				}

				// The disabled button styling.
				&:disabled {
					opacity: 0.5;
					cursor: not-allowed;
				}

				// Make the button icon white.
				svg {
					color: #fff;
				}
			}
		}

		// The filters area of the modal.
		&__filters {
			display: flex;
			flex-direction: column;
			gap: 14px;
			padding: 20px;
			border-top: 1px solid $palette-chat-border;
			background: $palette-label-background;

			// A section of content with fiters.
			&--section {
				display: flex;
				flex-wrap: wrap;
				align-items: flex-start;
				gap: 8px;

				// The title of the current filter section.
				&-title {
					margin: 16px 0 4px;
					width: 100%;
					font-size: 12px;
					font-weight: 400;
					line-height: 16px;
					text-align: left;
					color: $palette-text-body;
				}
			}

			// A sub-section of content with fiters, with the top border.
			&--sub-section {
				display: flex;
				flex-wrap: wrap;
				align-items: flex-start;
				gap: $section-gap;
				border-top: 1px solid $palette-chat-border;
				padding-top: 16px;
			}

			// The filter dropdown.
			&--select-div {
				position: relative;
				width: calc(50% - ($section-gap / 2)); // The width is half the parent width - half the parent column gap.

				input {

					&:focus,
					&:focus-visible {
						outline: 0;
						box-shadow: none;
						border: 0;
					}
				}
			}

			// The filter label buttons.
			&--label {
				font-size: 13px;
				font-weight: 400;
				line-height: 16px;
				cursor: pointer;
				background-color: #fff;
				color: $palette-text-body;
				border: 1px solid $palette-label-border;
				border-radius: 100px;
				padding: 6px 10px;
				display: flex;
				align-items: center;
				gap: 6px;
				-webkit-transition-property: color, background-color, border-color;
				-webkit-transition-duration: 100ms;
				-moz-transition-property: color, background-color, border-color;
				-moz-transition-duration: 100ms;
				-o-transition-property: color, background-color, border-color;
				-o-transition-duration: 100ms;
				transition-property: color, background-color, border-color;
				transition-duration: 100ms;

				// The SVGs inside the labels.
				svg {
					color: $palette-label-icon;
				}

				// The disabled label styling.
				&:disabled {
					opacity: 0.5;
					cursor: progress;
					background-color: #fff !important;
					color: $palette-text-body !important;
					border: 1px solid $palette-label-border !important;

					// The SVGs inside the labels.
					svg {
						color: $palette-label-icon !important;
					}
				}

				// The hover and focus styling for the label buttons.
				&:hover,
				&:focus-visible {
					outline: 0;
					box-shadow: none;
					color: #fff;
					background-color: $palette-primary;
					border-color: $palette-primary;

					// The SVGs inside the labels.
					svg {
						color: #fff;
					}
				}
			}
		}
	}

	&-errors {

		> div {
			margin: 12px;
			box-shadow: 0 0 3px 1px #cbbbbb;
			border-radius: 4px;
			padding: 14px;
			text-align: center;

			span {
				font-family: inherit;
				color: $palette-error;
				font-size: 14px;
				letter-spacing: 0.8px;
				font-weight: 600;
			}
		}
	}
}

// The overlay of the Zip AI sidebar.
.components-modal__screen-overlay:has(.spectra-open-ai-modal) {
	background-color: rgba(17, 24, 39, 0.05);
}

// Animation to spin the loader.
@keyframes spinner {

	0% {
		-ms-transform: rotate(0deg);
		-moz-transform: rotate(0deg);
		-webkit-transform: rotate(0deg);
		-o-transform: rotate(0deg);
		transform: rotate(0deg);
	}

	100% {
		-ms-transform: rotate(360deg);
		-moz-transform: rotate(360deg);
		-webkit-transform: rotate(360deg);
		-o-transform: rotate(360deg);
		transform: rotate(360deg);
	}
}

// Animation to slide-in the sidebar from the right.
@keyframes slideInRight {

	0% {
		right: -450px;
	}

	100% {
		right: 0;
	}
}

// Animation to pop-in a chat bubble.
@keyframes chatBubble {

	0% {
		opacity: 0;
		top: 25px;
	}

	90% {
		opacity: 1;
		top: -5px;
	}

	100% {
		top: 0;
	}
}

// Animation to make the loader dot(s) jump.
@keyframes jump {

	0% {
		top: 0;
		opacity: 0.5;
	}

	15% {
		top: -4px;
		opacity: 1;
	}

	30% {
		top: 2px;
		opacity: 0.5;
	}

	35% {
		top: 0;
	}
}
